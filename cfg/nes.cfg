# =============================================================================
# Mega Man 3 (U) â€” ld65 Linker Configuration
# Mapper 4 (MMC3): 256KB PRG + 128KB CHR
# =============================================================================

MEMORY {
    # iNES header
    HDR:      start = $0000, size = $0010, fill = yes, file = %O;

    # 32 x 8KB PRG banks
    # Base addresses match how MM3 maps each bank at runtime
    PRG00:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG01:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG02:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG03:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG04:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG05:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG06:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG07:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG08:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG09:    start = $8000, size = $2000, fill = yes, file = %O;
    PRG0A:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG0B:    start = $8000, size = $2000, fill = yes, file = %O;
    PRG0C:    start = $8000, size = $2000, fill = yes, file = %O;
    PRG0D:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG0E:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG0F:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG10:    start = $8000, size = $2000, fill = yes, file = %O;
    PRG11:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG12:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG13:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG14:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG15:    start = $8000, size = $2000, fill = yes, file = %O;
    PRG16:    start = $8000, size = $2000, fill = yes, file = %O;
    PRG17:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG18:    start = $A000, size = $2000, fill = yes, file = %O;
    PRG19:    start = $A000, size = $2000, fill = yes, file = %O;
    # Banks $1A/$1B: 16KB pair at $8000-$BFFF
    PRG1A:    start = $8000, size = $2000, fill = yes, file = %O;
    PRG1B:    start = $A000, size = $2000, fill = yes, file = %O;
    # Banks $1C/$1D: 16KB pair at $8000-$BFFF
    PRG1C:    start = $8000, size = $2000, fill = yes, file = %O;
    PRG1D:    start = $A000, size = $2000, fill = yes, file = %O;
    # Fixed bank: $1E/$1F as one 16KB block at $C000-$FFFF
    PRG_FIXED: start = $C000, size = $4000, fill = yes, file = %O;

    # 128KB CHR ROM
    CHR:      start = $0000, size = $20000, fill = yes, file = %O;
}

SEGMENTS {
    # iNES header
    HEADER:       load = HDR,   type = ro;

    # Swappable PRG banks
    BANK00:       load = PRG00, type = ro;
    BANK01:       load = PRG01, type = ro;
    BANK02:       load = PRG02, type = ro;
    BANK03:       load = PRG03, type = ro;
    BANK04:       load = PRG04, type = ro;
    BANK05:       load = PRG05, type = ro;
    BANK06:       load = PRG06, type = ro;
    BANK07:       load = PRG07, type = ro;
    BANK08:       load = PRG08, type = ro;
    BANK09:       load = PRG09, type = ro;
    BANK0A:       load = PRG0A, type = ro;
    BANK0B:       load = PRG0B, type = ro;
    BANK0C:       load = PRG0C, type = ro;
    BANK0D:       load = PRG0D, type = ro;
    BANK0E:       load = PRG0E, type = ro;
    BANK0F:       load = PRG0F, type = ro;
    BANK10:       load = PRG10, type = ro;
    BANK11:       load = PRG11, type = ro;
    BANK12:       load = PRG12, type = ro;
    BANK13:       load = PRG13, type = ro;
    BANK14:       load = PRG14, type = ro;
    BANK15:       load = PRG15, type = ro;
    BANK16:       load = PRG16, type = ro;
    BANK17:       load = PRG17, type = ro;
    BANK18:       load = PRG18, type = ro;
    BANK19:       load = PRG19, type = ro;

    # 16KB bank pairs
    BANK1A:       load = PRG1A, type = ro;
    BANK1B:       load = PRG1B, type = ro;
    BANK1C:       load = PRG1C, type = ro;
    BANK1D:       load = PRG1D, type = ro;

    # Fixed bank ($C000-$FFFF, single segment)
    FIXED:            load = PRG_FIXED, type = ro, start = $C000;

    # CHR ROM
    CHR:          load = CHR,   type = ro;
}
